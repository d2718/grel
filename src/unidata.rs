//! # unidata.rs
//!
//! Contains data about decomposable Unicode characters.

use std::collections::HashMap;

static DATA_LENGTH: usize = 2353;

// Array of raw data. This array is walked upon "initialization" to
// populate a HashMap in a more structured way.
//
// Each decomposable code point is encoded thus:
// 
// c, n, ...
//
// where
//  c  : the decomposable code point
//  n  : the number of code points into which this decomposes
//  ...: the ordered list of the n points into which c decomposes
//
//  This allows a single array to be walked linearly by an initializer,
//  and it also allows slices of this single array to be used.
//
static RAW_DATA: [u32; 2353] = [
  192, 2, 65, 768,
  193, 2, 65, 769,
  194, 2, 65, 770,
  195, 2, 65, 771,
  196, 2, 65, 776,
  197, 2, 65, 778,
  199, 2, 67, 807,
  200, 2, 69, 768,
  201, 2, 69, 769,
  202, 2, 69, 770,
  203, 2, 69, 776,
  204, 2, 73, 768,
  205, 2, 73, 769,
  206, 2, 73, 770,
  207, 2, 73, 776,
  209, 2, 78, 771,
  210, 2, 79, 768,
  211, 2, 79, 769,
  212, 2, 79, 770,
  213, 2, 79, 771,
  214, 2, 79, 776,
  216, 2, 79, 822,
  217, 2, 85, 768,
  218, 2, 85, 769,
  219, 2, 85, 770,
  220, 2, 85, 776,
  221, 2, 89, 769,
  224, 2, 97, 768,
  225, 2, 97, 769,
  226, 2, 97, 770,
  227, 2, 97, 771,
  228, 2, 97, 776,
  229, 2, 97, 778,
  231, 2, 99, 807,
  232, 2, 101, 768,
  233, 2, 101, 769,
  234, 2, 101, 770,
  235, 2, 101, 776,
  236, 2, 105, 768,
  237, 2, 105, 769,
  238, 2, 105, 770,
  239, 2, 105, 776,
  241, 2, 110, 771,
  242, 2, 111, 768,
  243, 2, 111, 769,
  244, 2, 111, 770,
  245, 2, 111, 771,
  246, 2, 111, 776,
  248, 2, 111, 821,
  249, 2, 117, 768,
  250, 2, 117, 769,
  251, 2, 117, 770,
  252, 2, 117, 776,
  253, 2, 121, 769,
  255, 2, 121, 776,
  256, 2, 65, 772,
  257, 2, 97, 772,
  258, 2, 65, 774,
  259, 2, 97, 774,
  260, 2, 65, 808,
  261, 2, 97, 808,
  262, 2, 67, 769,
  263, 2, 99, 769,
  264, 2, 67, 770,
  265, 2, 99, 770,
  266, 2, 67, 775,
  267, 2, 99, 775,
  268, 2, 67, 780,
  269, 2, 99, 780,
  270, 2, 68, 780,
  271, 2, 100, 780,
  272, 2, 68, 822,
  273, 2, 100, 821,
  274, 2, 69, 772,
  275, 2, 101, 772,
  276, 2, 69, 774,
  277, 2, 101, 774,
  278, 2, 69, 775,
  279, 2, 101, 775,
  280, 2, 69, 808,
  281, 2, 101, 808,
  282, 2, 69, 780,
  283, 2, 101, 780,
  284, 2, 71, 770,
  285, 2, 103, 770,
  286, 2, 71, 774,
  287, 2, 103, 774,
  288, 2, 71, 775,
  289, 2, 103, 775,
  290, 2, 71, 807,
  291, 2, 103, 807,
  292, 2, 72, 770,
  293, 2, 104, 770,
  294, 2, 72, 822,
  295, 2, 104, 821,
  296, 2, 73, 771,
  297, 2, 105, 771,
  298, 2, 73, 772,
  299, 2, 105, 772,
  300, 2, 73, 774,
  301, 2, 105, 774,
  302, 2, 73, 808,
  303, 2, 105, 808,
  304, 2, 73, 775,
  308, 2, 74, 770,
  309, 2, 106, 770,
  310, 2, 75, 807,
  311, 2, 107, 807,
  313, 2, 76, 769,
  314, 2, 108, 769,
  315, 2, 76, 807,
  316, 2, 108, 807,
  317, 2, 76, 780,
  318, 2, 108, 780,
  319, 1, 76,
  320, 1, 108,
  321, 2, 76, 822,
  322, 2, 108, 821,
  323, 2, 78, 769,
  324, 2, 110, 769,
  325, 2, 78, 807,
  326, 2, 110, 807,
  327, 2, 78, 780,
  328, 2, 110, 780,
  332, 2, 79, 772,
  333, 2, 111, 772,
  334, 2, 79, 774,
  335, 2, 111, 774,
  336, 2, 79, 779,
  337, 2, 111, 779,
  340, 2, 82, 769,
  341, 2, 114, 769,
  342, 2, 82, 807,
  343, 2, 114, 807,
  344, 2, 82, 780,
  345, 2, 114, 780,
  346, 2, 83, 769,
  347, 2, 115, 769,
  348, 2, 83, 770,
  349, 2, 115, 770,
  350, 2, 83, 807,
  351, 2, 115, 807,
  352, 2, 83, 780,
  353, 2, 115, 780,
  354, 2, 84, 807,
  355, 2, 116, 807,
  356, 2, 84, 780,
  357, 2, 116, 780,
  358, 2, 84, 822,
  359, 2, 116, 821,
  360, 2, 85, 771,
  361, 2, 117, 771,
  362, 2, 85, 772,
  363, 2, 117, 772,
  364, 2, 85, 774,
  365, 2, 117, 774,
  366, 2, 85, 778,
  367, 2, 117, 778,
  368, 2, 85, 779,
  369, 2, 117, 779,
  370, 2, 85, 808,
  371, 2, 117, 808,
  372, 2, 87, 770,
  373, 2, 119, 770,
  374, 2, 89, 770,
  375, 2, 121, 770,
  376, 2, 89, 776,
  377, 2, 90, 769,
  378, 2, 122, 769,
  379, 2, 90, 775,
  380, 2, 122, 775,
  381, 2, 90, 780,
  382, 2, 122, 780,
  384, 2, 98, 821,
  385, 2, 66, 777,
  386, 1, 66,
  387, 1, 98,
  391, 2, 67, 777,
  392, 2, 99, 777,
  394, 2, 68, 777,
  395, 1, 68,
  396, 1, 100,
  401, 2, 70, 777,
  402, 2, 102, 777,
  403, 2, 71, 777,
  407, 2, 73, 822,
  408, 2, 75, 777,
  409, 2, 107, 777,
  410, 1, 108,
  413, 1, 78,
  414, 1, 110,
  415, 2, 79, 820,
  416, 2, 79, 795,
  417, 2, 111, 795,
  420, 2, 80, 777,
  421, 2, 112, 777,
  427, 2, 116, 801,
  428, 2, 84, 777,
  429, 2, 116, 777,
  430, 2, 84, 802,
  431, 2, 85, 795,
  432, 2, 117, 795,
  434, 2, 86, 777,
  435, 2, 89, 777,
  436, 2, 121, 777,
  437, 2, 90, 822,
  438, 2, 122, 821,
  453, 1, 68,
  456, 1, 76,
  459, 1, 78,
  461, 2, 65, 780,
  462, 2, 97, 780,
  463, 2, 73, 780,
  464, 2, 105, 780,
  465, 2, 79, 780,
  466, 2, 111, 780,
  467, 2, 85, 780,
  468, 2, 117, 780,
  469, 3, 85, 776, 772,
  470, 3, 117, 776, 772,
  471, 3, 85, 776, 769,
  472, 3, 117, 776, 769,
  473, 3, 85, 776, 780,
  474, 3, 117, 776, 780,
  475, 3, 85, 776, 768,
  476, 3, 117, 776, 768,
  478, 3, 65, 776, 772,
  479, 3, 97, 776, 772,
  480, 3, 65, 775, 772,
  481, 3, 97, 775, 772,
  484, 2, 71, 822,
  485, 2, 103, 821,
  486, 2, 71, 780,
  487, 2, 103, 780,
  488, 2, 75, 780,
  489, 2, 107, 780,
  490, 2, 79, 808,
  491, 2, 111, 808,
  492, 3, 79, 808, 772,
  493, 3, 111, 808, 772,
  496, 2, 106, 780,
  498, 1, 68,
  500, 2, 71, 769,
  501, 2, 103, 769,
  504, 2, 78, 768,
  505, 2, 110, 768,
  506, 3, 65, 778, 769,
  507, 3, 97, 778, 769,
  510, 3, 79, 822, 769,
  511, 3, 111, 821, 769,
  512, 2, 65, 783,
  513, 2, 97, 783,
  514, 2, 65, 785,
  515, 2, 97, 785,
  516, 2, 69, 783,
  517, 2, 101, 783,
  518, 2, 69, 785,
  519, 2, 101, 785,
  520, 2, 73, 783,
  521, 2, 105, 783,
  522, 2, 73, 785,
  523, 2, 105, 785,
  524, 2, 79, 783,
  525, 2, 111, 783,
  526, 2, 79, 785,
  527, 2, 111, 785,
  528, 2, 82, 783,
  529, 2, 114, 783,
  530, 2, 82, 785,
  531, 2, 114, 785,
  532, 2, 85, 783,
  533, 2, 117, 783,
  534, 2, 85, 785,
  535, 2, 117, 785,
  536, 2, 83, 806,
  537, 2, 115, 806,
  538, 2, 84, 806,
  539, 2, 116, 806,
  542, 2, 72, 780,
  543, 2, 104, 780,
  544, 1, 78,
  545, 1, 100,
  548, 2, 90, 777,
  549, 2, 122, 777,
  550, 2, 65, 775,
  551, 2, 97, 775,
  552, 2, 69, 807,
  553, 2, 101, 807,
  554, 3, 79, 776, 772,
  555, 3, 111, 776, 772,
  556, 3, 79, 771, 772,
  557, 3, 111, 771, 772,
  558, 2, 79, 775,
  559, 2, 111, 775,
  560, 3, 79, 775, 772,
  561, 3, 111, 775, 772,
  562, 2, 89, 772,
  563, 2, 121, 772,
  564, 1, 108,
  565, 1, 110,
  566, 1, 116,
  570, 2, 65, 822,
  571, 2, 67, 822,
  572, 2, 99, 821,
  573, 1, 76,
  574, 2, 84, 824,
  575, 1, 115,
  576, 1, 122,
  579, 2, 66, 822,
  582, 2, 69, 822,
  583, 2, 101, 821,
  584, 2, 74, 822,
  585, 2, 106, 821,
  587, 2, 113, 802,
  588, 2, 82, 822,
  589, 2, 114, 821,
  590, 2, 89, 822,
  591, 2, 121, 821,
  7680, 2, 65, 805,
  7681, 2, 97, 805,
  7682, 2, 66, 775,
  7683, 2, 98, 775,
  7684, 2, 66, 803,
  7685, 2, 98, 803,
  7686, 2, 66, 817,
  7687, 2, 98, 817,
  7688, 3, 67, 807, 769,
  7689, 3, 99, 807, 769,
  7690, 2, 68, 775,
  7691, 2, 100, 775,
  7692, 2, 68, 803,
  7693, 2, 100, 803,
  7694, 2, 68, 817,
  7695, 2, 100, 817,
  7696, 2, 68, 807,
  7697, 2, 100, 807,
  7698, 2, 68, 813,
  7699, 2, 100, 813,
  7700, 3, 69, 772, 768,
  7701, 3, 101, 772, 768,
  7702, 3, 69, 772, 769,
  7703, 3, 101, 772, 769,
  7704, 2, 69, 813,
  7705, 2, 101, 813,
  7706, 2, 69, 816,
  7707, 2, 101, 816,
  7708, 3, 69, 807, 774,
  7709, 3, 101, 807, 774,
  7710, 2, 70, 775,
  7711, 2, 102, 775,
  7712, 2, 71, 772,
  7713, 2, 103, 772,
  7714, 2, 72, 775,
  7715, 2, 104, 775,
  7716, 2, 72, 803,
  7717, 2, 104, 803,
  7718, 2, 72, 776,
  7719, 2, 104, 776,
  7720, 2, 72, 807,
  7721, 2, 104, 807,
  7722, 2, 72, 814,
  7723, 2, 104, 814,
  7724, 2, 73, 816,
  7725, 2, 105, 816,
  7726, 3, 73, 776, 769,
  7727, 3, 105, 776, 769,
  7728, 2, 75, 769,
  7729, 2, 107, 769,
  7730, 2, 75, 803,
  7731, 2, 107, 803,
  7732, 2, 75, 817,
  7733, 2, 107, 817,
  7734, 2, 76, 803,
  7735, 2, 108, 803,
  7736, 3, 76, 803, 772,
  7737, 3, 108, 803, 772,
  7738, 2, 76, 817,
  7739, 2, 108, 817,
  7740, 2, 76, 813,
  7741, 2, 108, 813,
  7742, 2, 77, 769,
  7743, 2, 109, 769,
  7744, 2, 77, 775,
  7745, 2, 109, 775,
  7746, 2, 77, 803,
  7747, 2, 109, 803,
  7748, 2, 78, 775,
  7749, 2, 110, 775,
  7750, 2, 78, 803,
  7751, 2, 110, 803,
  7752, 2, 78, 817,
  7753, 2, 110, 817,
  7754, 2, 78, 813,
  7755, 2, 110, 813,
  7756, 3, 79, 771, 769,
  7757, 3, 111, 771, 769,
  7758, 3, 79, 771, 776,
  7759, 3, 111, 771, 776,
  7760, 3, 79, 772, 768,
  7761, 3, 111, 772, 768,
  7762, 3, 79, 772, 769,
  7763, 3, 111, 772, 769,
  7764, 2, 80, 769,
  7765, 2, 112, 769,
  7766, 2, 80, 775,
  7767, 2, 112, 775,
  7768, 2, 82, 775,
  7769, 2, 114, 775,
  7770, 2, 82, 803,
  7771, 2, 114, 803,
  7772, 3, 82, 803, 772,
  7773, 3, 114, 803, 772,
  7774, 2, 82, 817,
  7775, 2, 114, 817,
  7776, 2, 83, 775,
  7777, 2, 115, 775,
  7778, 2, 83, 803,
  7779, 2, 115, 803,
  7780, 3, 83, 769, 775,
  7781, 3, 115, 769, 775,
  7782, 3, 83, 780, 775,
  7783, 3, 115, 780, 775,
  7784, 3, 83, 803, 775,
  7785, 3, 115, 803, 775,
  7786, 2, 84, 775,
  7787, 2, 116, 775,
  7788, 2, 84, 803,
  7789, 2, 116, 803,
  7790, 2, 84, 817,
  7791, 2, 116, 817,
  7792, 2, 84, 813,
  7793, 2, 116, 813,
  7794, 2, 85, 804,
  7795, 2, 117, 804,
  7796, 2, 85, 816,
  7797, 2, 117, 816,
  7798, 2, 85, 813,
  7799, 2, 117, 813,
  7800, 3, 85, 771, 769,
  7801, 3, 117, 771, 769,
  7802, 3, 85, 772, 776,
  7803, 3, 117, 772, 776,
  7804, 2, 86, 771,
  7805, 2, 118, 771,
  7806, 2, 86, 803,
  7807, 2, 118, 803,
  7808, 2, 87, 768,
  7809, 2, 119, 768,
  7810, 2, 87, 769,
  7811, 2, 119, 769,
  7812, 2, 87, 776,
  7813, 2, 119, 776,
  7814, 2, 87, 775,
  7815, 2, 119, 775,
  7816, 2, 87, 803,
  7817, 2, 119, 803,
  7818, 2, 88, 775,
  7819, 2, 120, 775,
  7820, 2, 88, 776,
  7821, 2, 120, 776,
  7822, 2, 89, 775,
  7823, 2, 121, 775,
  7824, 2, 90, 770,
  7825, 2, 122, 770,
  7826, 2, 90, 803,
  7827, 2, 122, 803,
  7828, 2, 90, 817,
  7829, 2, 122, 817,
  7830, 2, 104, 817,
  7831, 2, 116, 776,
  7832, 2, 119, 778,
  7833, 2, 121, 778,
  7834, 2, 97, 855,
  7840, 2, 65, 803,
  7841, 2, 97, 803,
  7842, 2, 65, 777,
  7843, 2, 97, 777,
  7844, 3, 65, 770, 769,
  7845, 3, 97, 770, 769,
  7846, 3, 65, 770, 768,
  7847, 3, 97, 770, 768,
  7848, 3, 65, 770, 777,
  7849, 3, 97, 770, 777,
  7850, 3, 65, 770, 771,
  7851, 3, 97, 770, 771,
  7852, 3, 65, 770, 803,
  7853, 3, 97, 770, 803,
  7854, 3, 65, 774, 769,
  7855, 3, 97, 774, 769,
  7856, 3, 65, 774, 768,
  7857, 3, 97, 774, 768,
  7858, 3, 65, 774, 777,
  7859, 3, 97, 774, 777,
  7860, 3, 65, 774, 771,
  7861, 3, 97, 774, 771,
  7862, 3, 65, 774, 803,
  7863, 3, 97, 774, 803,
  7864, 2, 69, 803,
  7865, 2, 101, 803,
  7866, 2, 69, 777,
  7867, 2, 101, 777,
  7868, 2, 69, 771,
  7869, 2, 101, 771,
  7870, 3, 69, 770, 769,
  7871, 3, 101, 770, 769,
  7872, 3, 69, 770, 768,
  7873, 3, 101, 770, 768,
  7874, 3, 69, 770, 777,
  7875, 3, 101, 770, 777,
  7876, 3, 69, 770, 771,
  7877, 3, 101, 770, 771,
  7878, 3, 69, 770, 803,
  7879, 3, 101, 770, 803,
  7880, 2, 73, 777,
  7881, 2, 105, 777,
  7882, 2, 73, 803,
  7883, 2, 105, 803,
  7884, 2, 79, 803,
  7885, 2, 111, 803,
  7886, 2, 79, 777,
  7887, 2, 111, 777,
  7888, 3, 79, 770, 769,
  7889, 3, 111, 770, 769,
  7890, 3, 79, 770, 768,
  7891, 3, 111, 770, 768,
  7892, 3, 79, 770, 777,
  7893, 3, 111, 770, 777,
  7894, 3, 79, 770, 771,
  7895, 3, 111, 770, 771,
  7896, 3, 79, 770, 803,
  7897, 3, 111, 770, 803,
  7898, 3, 79, 795, 769,
  7899, 3, 111, 795, 769,
  7900, 3, 79, 795, 768,
  7901, 3, 111, 795, 768,
  7902, 3, 79, 795, 777,
  7903, 3, 111, 795, 777,
  7904, 3, 79, 795, 771,
  7905, 3, 111, 795, 771,
  7906, 3, 79, 795, 803,
  7907, 3, 111, 795, 803,
  7908, 2, 85, 803,
  7909, 2, 117, 803,
  7910, 2, 85, 777,
  7911, 2, 117, 777,
  7912, 3, 85, 795, 769,
  7913, 3, 117, 795, 769,
  7914, 3, 85, 795, 768,
  7915, 3, 117, 795, 768,
  7916, 3, 85, 795, 777,
  7917, 3, 117, 795, 777,
  7918, 3, 85, 795, 771,
  7919, 3, 117, 795, 771,
  7920, 3, 85, 795, 803,
  7921, 3, 117, 795, 803,
  7922, 2, 89, 768,
  7923, 2, 121, 768,
  7924, 2, 89, 803,
  7925, 2, 121, 803,
  7926, 2, 89, 777,
  7927, 2, 121, 777,
  7928, 2, 89, 771,
  7929, 2, 121, 771,
  7934, 1, 89,
  7935, 1, 121
];

/// This guy represents a character's decomposition.
/// base: the base code point of the decomposition (this will get rot13'd)
/// rest: a slice of the code points of the combining characters needed
///       to reconstruct the given character
///
pub struct Multichar<'a> {
    pub base: u32,
    pub rest: &'a [u32]
}

/// Walk the RAW_DATA array to populate a HashMap that maps code points to
/// the Multichar structs that represents their decompositions. Return that
/// HashMap.
///
/// # Example
///
/// ```
/// use grel::unidata::generate_hash;
/// static b: u32 = 117;
/// static r: &'static [u32] = &[795, 803];
///
/// let decomps = generate_hash();
/// let mch = decomps.get(&7921).unwrap();
///
/// assert_eq!(b, mch.base);
/// assert_eq!(r, mch.rest);
/// ```
pub fn generate_hash<'a>() -> HashMap<u32, Multichar<'a>> {
    let mut map = HashMap::new();
    let mut n: usize = 0;
    
    while n < DATA_LENGTH {
        let c = RAW_DATA[n];
        n = n + 1;
        let l: usize = RAW_DATA[n] as usize;
        n = n + 1;
        map.insert(c, Multichar {
                        base: RAW_DATA[n],
                        rest: &RAW_DATA[(n+1)..(n+l)]
                      });
        n = n + l;
    }
    
    map
}
